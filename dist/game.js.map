{"version":3,"sources":["webpack:///./src/helpers/Mixin.js","webpack:///./src/GameTypes.js","webpack:///./src/helpers/MathHelpers.js","webpack:///./src/ai/behaviours/StateBase.js","webpack:///./src/helpers/PositionHelpers.js","webpack:///./src/main.js","webpack:///./src/states/GameState.js","webpack:///./src/level/MapMaker.js","webpack:///./src/helpers/MapHelpers.js","webpack:///./src/factories/ItemFactory.js","webpack:///./src/entities/items/Item.js","webpack:///./src/factories/CreatureFactory.js","webpack:///./src/entities/npcs/Bug.js","webpack:///./src/helpers/AIHelpers.js","webpack:///./src/ai/Analyser.js","webpack:///./src/ai/FSM.js","webpack:///./src/ai/behaviours/Idle.js","webpack:///./src/ai/behaviours/Chase.js","webpack:///./src/ai/behaviours/Roam.js","webpack:///./src/factories/BlockFactory.js","webpack:///./src/entities/blocks/CoinBlock.js","webpack:///./src/entities/blocks/Block.js","webpack:///./src/entities/user/Player.js","webpack:///./src/data/StatManager.js"],"names":["MixinBuilder","superclass","mixins","reduce","c","mixin","TYPES","DIR","LEFT","RIGHT","MathHelpers","min","max","Math","ceil","floor","random","v","mx","mn","n","StateBase","id","owner","locked","PositionHelpers","v1","v2","Phaser","distance","x","y","target","me","Game","AUTO","state","add","start","GameState","game","levelConf","groundTile","mapData","load","image","json","stage","backgroundColor","MAX_SPEED","ACCELERATION","DRAG","GRAVITY","JUMP_SPEED","props","cache","getJSON","properties","player","name","physics","arcade","gravity","jumping","ground","group","enemies","items","TILE_BIAS","tileSize","levelMap","create","generateMap","input","keyboard","addKeyCapture","Keyboard","UP","DOWN","drawHeightMarkers","generatedMapData","mapJSON","tilex","tiley","tilen","mapCSV","generateCSV","addTilemap","Tilemap","CSV","levelTileMap","tilemap","addTilesetImage","setCollisionBetween","tiles","length","levelLayer","createLayer","i","currentEntity","find","ent","toLowerCase","collide","overlap","a","b","onPickup","itemData","value","kill","leftInputIsActive","body","acceleration","rightInputIsActive","onTheGround","blocked","down","jumps","upInputIsActive","velocity","upInputReleased","isDown","duration","downDuration","upDuration","bitmap","bitmapData","width","height","context","beginPath","strokeStyle","moveTo","lineTo","stroke","MapMaker","mapCache","area","map","concat","mapMaker","MapHelpers","u","r","d","l","sum","csvData","tileScore","arrayWidth","arrayHeight","atIndex","generateTileScore","ItemFactory","options","Pickup","args","existing","enable","Physics","ARCADE","immovable","allowGravity","Sprite","with","CreatureFactory","CreatureClass","Bug","collideWorldBounds","maxVelocity","setTo","drag","status","gambits","useState","isDefault","actionIfTrue","fsm","has_los","inLOS","has_dist","inDistance","analyse","sameAsCurrent","clear","pop","push","moveTowards","update","pos","dist","diff","direction","round","abs","spd","getRandomInt","AIHelpers","Analyser","defaultAction","gambitTest","node","conditionRunner","condition","data","identifier","againstStatus","against","allTrue","operator","percentile","and","every","subcondition","or","FSM","stack","params","top","enter","removed","splice","exit","filter","Idle","Chase","moveCallback","pickedPos","currentDir","moving","call","getTargetSide","Roam","BlockFactory","BlockClass","CoinBlock","onCollide","Signal","onInteract","console","log","Block","Player","stats","val","modifyStat","StatManager","stat","current","clamp"],"mappings":"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","file":"game.js","sourcesContent":["/// http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes/\r\n// Mixin maker\r\nclass MixinBuilder {\r\n  constructor(superclass) {\r\n    this.superclass = superclass;\r\n  }\r\n\r\n  // (spread operator, will pass everything from 0 to n)\r\n  with(...mixins) {\r\n    return mixins.reduce((c, mixin) => mixin(c), this.superclass);\r\n  }\r\n\r\n}\r\n\r\n// https://k94n.com/es6-modules-single-instance-pattern -> Revision needed\r\nexport default (superclass) => new MixinBuilder(superclass);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/Mixin.js","const TYPES = {\r\n  DIR: {\r\n    LEFT: -1,\r\n    RIGHT: 1\r\n  }\r\n};\r\n\r\nexport default TYPES;\n\n\n// WEBPACK FOOTER //\n// ./src/GameTypes.js","class MathHelpers {\r\n\r\n    static getRandomInt(min, max) {\r\n        min = Math.ceil(min);\r\n        max = Math.floor(max);\r\n        return Math.floor(Math.random() * (max - min)) + min;\r\n        //The maximum is exclusive and the minimum is inclusive\r\n    }\r\n\r\n    static clamp(v, c, mx, mn) {\r\n        let n = v + c;\r\n        mn = mn ? mn : 0;\r\n        return n < mn ? mn : (n > mx ? mx : n);\r\n    }\r\n\r\n}\r\n\r\nexport default MathHelpers;\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/MathHelpers.js","class StateBase {\r\n\r\n    constructor() {\r\n        \r\n        this.id = \"undefined\";\r\n        this.owner = null;\r\n        this.locked = false;\r\n\r\n    }\r\n\r\n    enter() {\r\n        //...\r\n    }\r\n\r\n    update() {\r\n        //...\r\n    }\r\n\r\n    exit() {\r\n        //...\r\n    }\r\n\r\n}\r\n\r\nexport default StateBase;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/behaviours/StateBase.js","import TYPES from '../GameTypes';\r\n\r\nclass PositionHelpers {\r\n\r\n    static dist(v1, v2) {\r\n\r\n        return Phaser.Math.distance(v1.x, v1.y, v2.x, v2.y);\r\n\r\n    }\r\n\r\n    static getTargetSide(target, me) {\r\n\r\n        return target.x - me.x < 0 ? TYPES.DIR.LEFT : TYPES.DIR.RIGHT;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default PositionHelpers;\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/PositionHelpers.js","import 'pixi';\r\nimport 'p2';\r\nimport Phaser from 'phaser';\r\nimport GameState from './states/GameState';\r\n\r\n/// So how about using TypeScript?\r\n// https://github.com/belohlavek/phaser-es6-boilerplate\r\n// We extend Phaser.Game to avoid contextual issues when attaching to the lib.\r\nclass Game extends Phaser.Game {\r\n\r\n  constructor() {\r\n    super(500, 500, Phaser.AUTO, 'container', null);\r\n\t\tthis.state.add('GameState', GameState, false);\r\n\t\tthis.state.start('GameState');\r\n  }\r\n\r\n}\r\n\r\n// Then a simple case of starting everything here.\r\nnew Game();\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import TYPES from '../GameTypes';\r\nimport mix from '../helpers/Mixin';\r\nimport Phaser from 'phaser';\r\nimport MapMaker from '../level/MapMaker';\r\nimport MapHelpers from '../helpers/MapHelpers';\r\nimport ItemFactory from '../factories/ItemFactory';\r\nimport CreatureFactory from '../factories/CreatureFactory';\r\nimport BlockFactory from '../factories/BlockFactory';\r\nimport Player from '../entities/user/Player';\r\n\r\n/// https://gamemechanicexplorer.com/#platformer-6\r\n// At this point GameState doesn't really need to extend anything, it's more Sprites and things that should.\r\nclass GameState {\r\n\r\n  constructor(game) {\r\n    // ... If it isn't already...\r\n    this.game = game;\r\n  }\r\n\r\n  // Prototypal methods\r\n  // Load images and sounds\r\n  preload() {\r\n\r\n    // Differs per level\r\n    let levelConf = {\r\n      groundTile: './assets/gfx/ground.png',\r\n      mapData: './assets/mapdata/sandbox.json'\r\n    };\r\n\r\n    // Some media to play with\r\n    this.game.load.image('ground', levelConf.groundTile);\r\n    this.game.load.image('player', './assets/gfx/player.png');\r\n    this.game.load.image('bug', './assets/gfx/bug.png');\r\n    this.game.load.image('life', './assets/gfx/oneup.png');\r\n    this.game.load.image('coin', './assets/gfx/coin.png');\r\n    this.game.load.image('tiles', './assets/tilemaps/tiles/salt-tiles.png');\r\n\r\n    // The various amounts of game data used\r\n    this.game.load.json('player', './assets/gamedata/playerData.json');\r\n    this.game.load.json('enemies', './assets/gamedata/enemies.json');\r\n    this.game.load.json('items', './assets/gamedata/items.json');\r\n\r\n    // Map data (sandbox is all we have right now)\r\n    this.game.load.json('mapdata-sandbox', levelConf.mapData);\r\n\r\n  }\r\n\r\n  // Setup the example\r\n  create() {\r\n    // Set stage background to something sky colored\r\n    this.game.stage.backgroundColor = 0x88BBcc;\r\n\r\n    // Define movement constants\r\n    this.MAX_SPEED = 250; // pixels/second\r\n    this.ACCELERATION = 2500; // pixels/second/second\r\n    this.DRAG = 1500; // pixels/second\r\n    this.GRAVITY = 2500; // pixels/second/second - note: anything above this causes you to fall through tiles... :/\r\n    this.JUMP_SPEED = -500; // pixels/second (negative y is up)\r\n\r\n    // Create a player sprite\r\n    let props = this.game.cache.getJSON('player').properties;\r\n    this.player = new Player({\r\n      game: this.game,\r\n      x: 4 * 32,\r\n      y: 2 * 32,\r\n      name: 'player',\r\n      properties: props,\r\n      MAX_SPEED: this.MAX_SPEED,\r\n      DRAG: this.DRAG\r\n    });\r\n\r\n    // Since we're jumping we need gravity\r\n    this.game.physics.arcade.gravity.y = this.GRAVITY;\r\n\r\n    // Flag to track if the jump button is pressed\r\n    this.jumping = false;\r\n\r\n    // Create some groups to house the tiles / items, etc\r\n    this.ground = this.game.add.group();\r\n    this.enemies = this.game.add.group();\r\n    this.items = this.game.add.group();\r\n\r\n    // Retrieve the levels map data and set the tile scaling\r\n    this.game.physics.arcade.TILE_BIAS = 40; // Prevents strange tile fall-through\r\n    let mapData = this.game.cache.getJSON('mapdata-sandbox');\r\n    let tileSize = 32;\r\n\r\n    // Now we can generate the map\r\n    let levelMap = MapMaker.create(mapData, tileSize);\r\n    this.generateMap(levelMap, mapData, tileSize);\r\n\r\n    // Capture certain keys to prevent their default actions in the browser.\r\n    // This is only necessary because this is an HTML5 game. Games on other\r\n    // platforms may not need code like this.\r\n    this.game.input.keyboard.addKeyCapture([\r\n      Phaser.Keyboard.LEFT,\r\n      Phaser.Keyboard.RIGHT,\r\n      Phaser.Keyboard.UP,\r\n      Phaser.Keyboard.DOWN\r\n    ]);\r\n\r\n    // Just for fun, draw some height markers so we can see how high we're jumping\r\n    this.drawHeightMarkers();\r\n  }\r\n\r\n  generateMap(generatedMapData, mapJSON, tileSize) {\r\n\r\n    let tilex = 0;\r\n    let tiley = 0;\r\n    let tilen = 0;\r\n\r\n    //  Generates CSV data based on the raw map data supplied\r\n    let mapCSV = MapHelpers.generateCSV(generatedMapData);\r\n\r\n    //  Add data to the cache\r\n    this.game.cache.addTilemap('dynamicMap', null, mapCSV, Phaser.Tilemap.CSV);\r\n\r\n    //  Create our map (the 32x32 is the tile size)\r\n    this.levelTileMap = this.game.add.tilemap('dynamicMap', tileSize, tileSize);\r\n\r\n    //  'tiles' = cache image key, 32x32 = tile size\r\n    this.levelTileMap.addTilesetImage('tiles', 'tiles', tileSize, tileSize);\r\n\r\n    //  Enable collisions on all tiles on this layer\r\n    this.levelTileMap.setCollisionBetween(0, this.levelTileMap.tiles.length);\r\n\r\n    //  0 is important\r\n    this.levelLayer = this.levelTileMap.createLayer(0);\r\n\r\n    /// .............. Items\r\n    for (let i = 0; i < mapJSON.items.length; i++) {\r\n\r\n      let currentEntity = mapJSON.items[i];\r\n      let props = this.game.cache.getJSON('items').find(x => x.id === currentEntity.id).properties;\r\n\r\n      let ent = ItemFactory.create({\r\n        game: this.game,\r\n        x: currentEntity.x * tileSize,\r\n        y: currentEntity.y * tileSize,\r\n        name: currentEntity.name.toLowerCase(),\r\n        properties: props\r\n      });\r\n\r\n      this.items.add(ent);\r\n\r\n    }\r\n\r\n    /// .............. Enemies\r\n    for (let i = 0; i < mapJSON.enemies.length; i++) {\r\n\r\n      let currentEntity = mapJSON.enemies[i];\r\n      let props = this.game.cache.getJSON('enemies').find(x => x.id === currentEntity.id).properties;\r\n\r\n      let ent = CreatureFactory.create({\r\n        game: this.game,\r\n        x: currentEntity.x * tileSize,\r\n        y: currentEntity.y * tileSize,\r\n        id: currentEntity.id,\r\n        name: currentEntity.name.toLowerCase(),\r\n        target: this.player,\r\n        properties: props\r\n      });\r\n\r\n      this.enemies.add(ent);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    // Collide layers and players\r\n    this.game.physics.arcade.collide(this.player, this.levelLayer);\r\n    this.game.physics.arcade.collide(this.enemies, this.levelLayer);\r\n\r\n    // Collide the player with items - modify based on pickup stat\r\n    this.game.physics.arcade.overlap(this.player, this.items, function (a, b) {\r\n      a.onPickup(b.itemData.id, b.itemData.value);\r\n      b.kill();\r\n    });\r\n\r\n    if (this.leftInputIsActive()) {\r\n      this.player.body.acceleration.x = -this.ACCELERATION;\r\n    } else if (this.rightInputIsActive()) {\r\n      this.player.body.acceleration.x = this.ACCELERATION;\r\n    } else {\r\n      this.player.body.acceleration.x = 0;\r\n    }\r\n\r\n    // Set a variable that is true when the player is touching the ground\r\n    let onTheGround = this.player.body.blocked.down; // this.player.body.touching.down; - Only works on arcade physics bodies. Not tiles apparently...\r\n\r\n    // If the player is touching the ground, let him have 2 jumps\r\n    if (onTheGround) {\r\n      this.jumps = 2;\r\n      this.jumping = false;\r\n    }\r\n\r\n    // Jump! Keep y velocity constant while the jump button is held for up to 150 ms\r\n    if (this.jumps > 0 && this.upInputIsActive(150)) {\r\n      this.player.body.velocity.y = this.JUMP_SPEED;\r\n      this.jumping = true;\r\n    }\r\n\r\n    // Reduce the number of available jumps if the jump input is released\r\n    if (this.jumping && this.upInputReleased()) {\r\n      this.jumps--;\r\n      this.jumping = false;\r\n    }\r\n  }\r\n\r\n  // This function should return true when the player activates the \"go left\" control\r\n  // In this case, either holding the right arrow or tapping or clicking on the left\r\n  // side of the screen.\r\n  leftInputIsActive() {\r\n    return this.input.keyboard.isDown(Phaser.Keyboard.LEFT);\r\n  }\r\n\r\n  // This function should return true when the player activates the \"go right\" control\r\n  // In this case, either holding the right arrow or tapping or clicking on the right\r\n  // side of the screen.\r\n  rightInputIsActive() {\r\n    return this.input.keyboard.isDown(Phaser.Keyboard.RIGHT);\r\n  }\r\n\r\n  // This function should return true when the player activates the \"jump\" control\r\n  // In this case, either holding the up arrow or tapping or clicking on the center\r\n  // part of the screen.\r\n  upInputIsActive(duration) {\r\n    return this.input.keyboard.downDuration(Phaser.Keyboard.UP, duration);\r\n  }\r\n\r\n  // This function returns true when the player releases the \"jump\" control\r\n  upInputReleased() {\r\n    return this.input.keyboard.upDuration(Phaser.Keyboard.UP);\r\n  }\r\n\r\n  drawHeightMarkers() {\r\n    // Create a bitmap the same size as the stage\r\n    let bitmap = this.game.add.bitmapData(this.game.width, this.game.height);\r\n\r\n    // These functions use the canvas context to draw lines using the canvas API\r\n    for (let y = this.game.height - 20; y >= 0; y -= 32) {\r\n      bitmap.context.beginPath();\r\n      bitmap.context.strokeStyle = 'rgba(255, 255, 255, 0.2)';\r\n      bitmap.context.moveTo(0, y);\r\n      bitmap.context.lineTo(this.game.width, y);\r\n      bitmap.context.stroke();\r\n    }\r\n\r\n    this.game.add.image(0, 0, bitmap);\r\n  }\r\n\r\n}\r\n\r\nexport default GameState;\n\n\n// WEBPACK FOOTER //\n// ./src/states/GameState.js","class MapMaker {\r\n\r\n    constructor() {\r\n        this.mapCache = [];\r\n        this.area = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n    }\r\n\r\n    // Remember you cannot use/access static methods through class instances!\r\n    create(mapData, tileSize) {\r\n\r\n        this.width = mapData.map[0].length;\r\n        this.height = mapData.map.length;\r\n        this.area = this.width * this.height;\r\n        this.mapCache = mapData.map.reduce((a, b) => a.concat(b));\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    atIndex(i) {\r\n\r\n        if(i < 0 || i > this.mapCache.length - 1)\r\n            return null;\r\n\r\n        return this.mapCache[i];\r\n\r\n    }\r\n\r\n}\r\n\r\n// Ensures singleton state (I think...)\r\nlet mapMaker = mapMaker ? mapMaker : new MapMaker();\r\nexport default mapMaker;\n\n\n// WEBPACK FOOTER //\n// ./src/level/MapMaker.js","class MapHelpers {\r\n\r\n    static generateTileScore(u, r, d, l) {\r\n        let sum = 0;\r\n        sum += u ? 1 : 0;\r\n        sum += l ? 2 : 0;\r\n        sum += d ? 4 : 0;\r\n        sum += r ? 8 : 0;\r\n        return sum;\r\n    }\r\n\r\n    static generateCSV(mapData) {\r\n   \r\n        let csvData = '';\r\n        let tileScore = 0;\r\n        let arrayWidth = mapData.width - 1;\r\n        let arrayHeight = mapData.height - 1;\r\n\r\n        // https://phaser.io/examples/v2/tilemaps/create-from-array#download\r\n        // Doesn't have to be CSV, you can quite happily use json probably.\r\n        // Feel free to change this so it picks n*2 of the number to pick a tile variant.\r\n        for (let x = 0; x < mapData.area; x += 1) {\r\n\r\n            // Generate tile scores based on neighbours (we only care about '1' here, use enums)\r\n            if (mapData.atIndex(x) === 1) {\r\n\r\n                // We know this tile has a block, so we want to know if it has nehbours\r\n                // Don't be mislead, we need the real width, not zero-based here since we're dealing with number of squares\r\n                // as opposed to 'index' of squares.\r\n                tileScore = this.generateTileScore(\r\n                    mapData.atIndex(x - mapData.width), // up\r\n                    mapData.atIndex(x + 1), // right\r\n                    mapData.atIndex(x + mapData.width), // below\r\n                    mapData.atIndex(x - 1) // left\r\n                );\r\n\r\n            } else {\r\n\r\n                // Nothing of interest surrounding us, treat as empty tile\r\n                tileScore = -1;\r\n\r\n            }\r\n\r\n            // Generate node in data\r\n            csvData += tileScore;\r\n\r\n            // Ensure you don't append a comma at the end\r\n            if (x < mapData.area - 1)\r\n                csvData += ',';\r\n\r\n            // Edge of row reached, increment to next\r\n            if (x % mapData.width === arrayWidth)\r\n                csvData += '\\n';\r\n\r\n        }\r\n\r\n        return csvData;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default MapHelpers;\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/MapHelpers.js","import Item from '../entities/items/Item';\r\n\r\nclass ItemFactory {\r\n\r\n    static create(options) {\r\n        return new Item(options);\r\n    }\r\n\r\n}\r\n\r\nexport default ItemFactory;\n\n\n// WEBPACK FOOTER //\n// ./src/factories/ItemFactory.js","import mix from '../../helpers/Mixin';\r\n\r\nclass Pickup extends mix(Phaser.Sprite).with() {\r\n\r\n    constructor(args) {\r\n\r\n        super(args.game, args.x, args.y, args.name);\r\n        args.game.add.existing(this);\r\n\r\n        let game = args.game;\r\n\r\n        game.physics.enable(this, Phaser.Physics.ARCADE);\r\n        this.body.immovable = true;\r\n        this.body.allowGravity = false;\r\n\r\n        this.itemData = {\r\n            id: args.properties.id,\r\n            value: args.properties.value\r\n        };\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Pickup;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/items/Item.js","import Bug from '../entities/npcs/Bug';\r\n\r\nclass CreatureFactory {\r\n\r\n    static create(options) {\r\n        \r\n        let CreatureClass = null;\r\n\r\n        switch(options.id) {\r\n            case \"bug\":\r\n                CreatureClass = Bug;\r\n                break;\r\n        }\r\n\r\n        return new CreatureClass(options);\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default CreatureFactory;\n\n\n// WEBPACK FOOTER //\n// ./src/factories/CreatureFactory.js","import TYPES from '../../GameTypes';\r\nimport mix from '../../helpers/Mixin';\r\nimport AIHelpers from '../../helpers/AIHelpers';\r\nimport PositionHelpers from '../../helpers/PositionHelpers';\r\nimport MathHelpers from '../../helpers/MathHelpers';\r\nimport Analyser from '../../ai/Analyser';\r\n\r\nimport FSM from '../../ai/FSM';\r\nimport ChaseBehaviour from '../../ai/behaviours/Chase';\r\nimport RoamBehaviour from '../../ai/behaviours/Roam';\r\n\r\nclass Bug extends mix(Phaser.Sprite).with(Analyser) {\r\n\r\n    constructor(args) {\r\n\r\n        super(args.game, args.x, args.y, args.name);\r\n        args.game.add.existing(this);\r\n\r\n        let game = args.game;\r\n\r\n        game.physics.enable(this, Phaser.Physics.ARCADE);\r\n        this.body.collideWorldBounds = true;\r\n        this.body.maxVelocity.setTo(args.properties.physics.MAX_SPEED, args.properties.physics.MAX_SPEED * 10);\r\n        this.body.drag.setTo(args.properties.physics.DRAG, 0);\r\n\r\n        this.status = args.properties.status;\r\n        this.gambits = args.properties.gambits;\r\n        this.target = args.target;\r\n\r\n        this.useState = this.gambits.find(x => x.isDefault).actionIfTrue;\r\n\r\n        this.fsm = new FSM();\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        // The computation takes place in the entity, since its world status is referenced from its own pov.\r\n        this.status.has_los = AIHelpers.inLOS(this, this.target);\r\n        this.status.has_dist = AIHelpers.inDistance(this, this.target);\r\n\r\n        // Then we feed in the world status and decide what to do with ourselves.\r\n        this.useState = this.analyse(this.gambits, this.status, this.target);\r\n\r\n        // When we have an action string, we know what state to push / activate.\r\n        /// Needs to use types, not strings, also, is this comparison a little slow?\r\n        /// Is it also a little slow to instantiate like this? Why not cache them? TODO.\r\n        /// Do we have the right way of calling the move function here?\r\n        //// This area could use a little work. I'd suggest resorting to types instead of strings and whatnot.\r\n        if (this.useState === \"idle\" && !this.fsm.sameAsCurrent(this.useState)) {\r\n            this.fsm.clear();\r\n        }\r\n\r\n        if (this.useState === \"roam\" && !this.fsm.sameAsCurrent(this.useState)) {\r\n            this.fsm.pop();\r\n            this.fsm.push(new RoamBehaviour(this, this.status, this.moveTowards));\r\n        }\r\n\r\n        if (this.useState === \"chase\" && !this.fsm.sameAsCurrent(this.useState)) {\r\n            this.fsm.pop();\r\n            this.fsm.push(new ChaseBehaviour(this, this.status, this.target, this.moveTowards));\r\n        }\r\n\r\n        this.fsm.update(this.status);\r\n\r\n    }\r\n\r\n    moveTowards(pos) {\r\n\r\n        this.body.velocity.x = 0;\r\n\r\n        if (PositionHelpers.dist(pos, { x: this.x, y: this.y }) > 2) {\r\n\r\n            let diff = {\r\n                x: pos.x - this.x\r\n            };\r\n\r\n            // Use enums for these magic strings, applies all over!\r\n            let direction = diff.x < 0 ? TYPES.DIR.LEFT : TYPES.DIR.RIGHT;\r\n\r\n            // Don't use an arbitrary distance number, at least pass it as an arg. Or better yet, get from gambit.\r\n            if (Math.round(Math.abs(diff.x)) > 10) {\r\n                let spd = MathHelpers.getRandomInt(80, 130);\r\n                this.body.velocity.x = direction === TYPES.DIR.LEFT ? -spd : spd;\r\n                return true;\r\n            } else {\r\n                this.body.velocity.x = 0;\r\n                return false;\r\n            }\r\n\r\n        }\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Bug;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/npcs/Bug.js","class AIHelpers {\r\n\r\n    static inLOS(a, b)\r\n    {\r\n        // To implement from:\r\n        // https://gamemechanicexplorer.com/#raycasting-1\r\n        // console.log(a, b);\r\n        return true;\r\n    }\r\n\r\n    static inDistance(v1, v2)\r\n    {\r\n        return Phaser.Math.distance(v1.x, v1.y, v2.x, v2.y);\r\n    }\r\n\r\n}\r\n\r\nexport default AIHelpers;\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/AIHelpers.js","let Analyser = (superclass) => class extends superclass {\r\n    \r\n    // https://bitbucket.org/drunkenoodle/rpg-turn-based-proto/src/b98fbc1356938739acf0ef77b47502847f8d5652/src/data/definitions.js?at=master&fileviewer=file-view-default\r\n    analyse(gambits, status, target) {\r\n\r\n        /// Remember it's just 1 on 1 right now, so target picking is a bit redundant. However,\r\n        /// it might decide to pick its self.\r\n        // Gets the list of gambit nodes to return from analyses\r\n        let defaultAction = gambits.find(x => x.isDefault);\r\n        let gambitTest = gambits.find(function (node) {\r\n            return this.conditionRunner(node, status);\r\n        }, this);\r\n\r\n        return gambitTest ? gambitTest.actionIfTrue : defaultAction.actionIfTrue; // What happens if non-true ? Perform default?\r\n\r\n    };\r\n\r\n    conditionRunner(condition, data) {\r\n\r\n        // For each condition, run the stats against it.\r\n        let status = data[condition.identifier];\r\n        // If against specific static value not specified, we just revert to the actual condition value (things like distance use this).\r\n        let againstStatus = condition.against ? data[condition.against] : condition.value;\r\n        // This needs to be true for this gambit to pass.\r\n        let allTrue = false;\r\n\r\n        // Some type checking would be useful here too.\r\n        switch (condition.operator) {\r\n            case 'boolean':\r\n                allTrue = status === condition.value;\r\n                break;\r\n            case 'less_than':\r\n                allTrue = condition.value > 0 && condition.percentile ? status < (againstStatus * condition.value) : status < againstStatus;\r\n                break;\r\n            case 'greater_than':\r\n                allTrue = condition.value > 0 && condition.percentile ? status > (againstStatus * condition.value) : status > againstStatus;\r\n                break;\r\n            case 'equal_to':\r\n                allTrue = condition.value === status;\r\n                break;\r\n            case 'not_equal_to':\r\n                allTrue = condition.value !== status;\r\n                break;\r\n        }\r\n\r\n        if (condition.and && condition.and.length > 0) {\r\n\r\n            return condition.and.every(function (subcondition) {\r\n                return this.conditionRunner(subcondition, data);\r\n            }, this) && allTrue;\r\n\r\n        }\r\n\r\n        if (condition.or && condition.or.length > 0) {\r\n\r\n            return condition.and.every(function (subcondition) {\r\n                return this.conditionRunner(subcondition, data);\r\n            }, this) || allTrue;\r\n\r\n        }\r\n\r\n        return allTrue;\r\n\r\n    };\r\n\r\n}\r\n\r\nexport default Analyser;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/Analyser.js","import IdleBehaviour from './behaviours/Idle';\r\n\r\nclass FSM {\r\n\r\n    constructor() {\r\n        this.stack = [];\r\n        this.stack.push(new IdleBehaviour());\r\n    }\r\n\r\n    update(params) {\r\n\r\n        this.top().update(params);\r\n\r\n    }\r\n\r\n    push(state, params) {\r\n\r\n        if (this.stack.find(x => x.id === state.id))\r\n            throw \" - State duplication error, check you aren't pushing the same type.\";\r\n\r\n        this.stack.push(state);\r\n\r\n        this.top().enter(params);\r\n\r\n    }\r\n\r\n    top() {\r\n        return this.stack[this.stack.length - 1];\r\n    }\r\n\r\n    pop() {\r\n\r\n        if (this.stack.length === 0)\r\n            throw \" - No states to use!\";\r\n\r\n        if (this.top().locked)\r\n            return;\r\n\r\n        let removed = this.stack.splice(this.stack.length - 1, 1)[0];\r\n        removed.exit();\r\n\r\n        // GC (wouldn't have to do this if they were cached instead)\r\n        removed = null;\r\n\r\n    }\r\n\r\n    clear() {\r\n\r\n        this.stack = this.stack.filter(x => x.locked);\r\n\r\n        if (this.stack.length > 1)\r\n            throw \" - Can only have one locked state.\";\r\n\r\n    }\r\n\r\n    sameAsCurrent(id) {\r\n        return this.top().id === id;\r\n    }\r\n\r\n}\r\n\r\nexport default FSM;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/FSM.js","import StateBase from '../../ai/behaviours/StateBase';\r\n\r\nclass Idle extends StateBase {\r\n\r\n    constructor() {\r\n        \r\n        super();\r\n        \r\n        this.id = \"idle\";\r\n        this.locked = true;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Idle;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/behaviours/Idle.js","import TYPES from '../../GameTypes';\r\nimport StateBase from '../../ai/behaviours/StateBase';\r\nimport PositionHelpers from '../../helpers/PositionHelpers';\r\n\r\nclass Chase extends StateBase {\r\n\r\n    constructor(owner, status, target, moveCallback) {\r\n\r\n        super();\r\n\r\n        this.id = \"chase\";\r\n        this.status = status;\r\n        this.owner = owner;\r\n\r\n        this.moveCallback = moveCallback;\r\n        this.target = target;\r\n        this.pickedPos = {\r\n            x: this.target.x,\r\n            y: this.target.y\r\n        };\r\n\r\n        this.currentDir = TYPES.DIR.RIGHT;\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        let moving = this.moveCallback.call(this.owner, this.pickedPos);\r\n\r\n        if (this.currentDir !== PositionHelpers.getTargetSide(this.target, this.owner) || !moving) {\r\n            this.currentDir = PositionHelpers.getTargetSide(this.target, this.owner);\r\n            this.pickedPos.x = this.target.x;\r\n        }\r\n\r\n    }\r\n\r\n};\r\n\r\nexport default Chase;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/behaviours/Chase.js","import StateBase from '../../ai/behaviours/StateBase';\r\nimport MathHelpers from '../../helpers/MathHelpers';\r\n\r\nclass Roam extends StateBase {\r\n\r\n    constructor(owner, status, moveCallback) {\r\n\r\n        super();\r\n\r\n        this.id = \"roam\";\r\n        this.status = status;\r\n        this.owner = owner;\r\n\r\n        this.moveCallback = moveCallback;\r\n        this.pickedPos = {\r\n            x: this.owner.x,\r\n            y: this.owner.y\r\n        };\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        let moving = this.moveCallback.call(this.owner, this.pickedPos);\r\n\r\n        if (!moving) {\r\n            this.pickedPos.x = MathHelpers.getRandomInt(2 * 32, 15 * 32);\r\n            this.pickedPos.y = this.pickedPos.y;\r\n        }\r\n\r\n    }\r\n\r\n};\r\n\r\nexport default Roam;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/behaviours/Roam.js","import CoinBlock from '../entities/blocks/CoinBlock';\r\n\r\nclass BlockFactory {\r\n\r\n    static create(options) {\r\n        \r\n        let BlockClass = null;\r\n\r\n        switch(options.id) {\r\n            case \"coin\":\r\n                BlockClass = CoinBlock;\r\n                break;\r\n        }\r\n\r\n        return new BlockClass(options);\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default BlockFactory;\n\n\n// WEBPACK FOOTER //\n// ./src/factories/BlockFactory.js","import mix from '../../helpers/Mixin';\r\nimport Block from '../blocks/Block';\r\n\r\nclass CoinBlock extends mix(Block).with() {\r\n\r\n    // Coin blocks need to make use of mixins for the extra functionality given.\r\n    constructor(args) {       \r\n        \r\n        super(args);\r\n        \r\n        this.body.onCollide = new Phaser.Signal();\r\n        this.body.onCollide.add(this.onInteract, this);\r\n\r\n    }\r\n\r\n    onInteract() { // <-- Can this be called from in here?\r\n        \r\n        console.log(\"Player hit me!\");\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default CoinBlock;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/blocks/CoinBlock.js","class Block extends Phaser.Sprite {\r\n\r\n    constructor(args) {\r\n\r\n        // Normal blocks don't really do much, so we don't need mixins for them.\r\n        super(args.game, args.x, args.y, args.name);\r\n        args.game.add.existing(this);\r\n\r\n        let game = args.game;\r\n\r\n        game.physics.enable(this, Phaser.Physics.ARCADE);\r\n        this.body.immovable = true;\r\n        this.body.allowGravity = false;\r\n        \r\n    }\r\n\r\n}\r\n\r\nexport default Block;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/blocks/Block.js","import mix from '../../helpers/Mixin';\r\nimport StatManager from '../../data/StatManager';\r\n\r\nclass Player extends mix(Phaser.Sprite).with(StatManager) {\r\n\r\n    constructor(args) {\r\n\r\n        super(args.game, args.x, args.y, args.name);\r\n        args.game.add.existing(this);\r\n\r\n        let game = args.game;\r\n\r\n        game.physics.enable(this, Phaser.Physics.ARCADE);\r\n        this.body.collideWorldBounds = true;\r\n        this.body.maxVelocity.setTo(args.MAX_SPEED, args.MAX_SPEED * 10);\r\n        this.body.drag.setTo(args.DRAG, 0);\r\n\r\n        this.stats = args.properties.stats;\r\n\r\n    }\r\n\r\n    onPickup(id, val) {\r\n        this.modifyStat(id, val, this.stats);\r\n    }\r\n\r\n    onDamaged(val) {\r\n        // ...\r\n    }\r\n\r\n}\r\n\r\nexport default Player;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/user/Player.js","import MathHelpers from \"../helpers/MathHelpers\";\r\n\r\nlet StatManager = (superclass) => class extends superclass {\r\n\r\n    modifyStat(id, n, stats) {\r\n\r\n        let stat = stats.find(x => x.id === id);\r\n        stat.current = MathHelpers.clamp(n, stat.current, stat.max);\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\nexport default StatManager;\n\n\n// WEBPACK FOOTER //\n// ./src/data/StatManager.js"],"sourceRoot":""}